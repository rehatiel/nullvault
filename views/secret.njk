{% extends "base.njk" %}

{% block head %}
<script defer src="/secret.js"></script>
{% endblock %}

{% block content %}

{% if template == 'banking' %}
<div class="tpl-banking-header">
  <div class="tpl-banking-logo">ğŸ¦ SecureBank</div>
  <div class="tpl-banking-sub">Secure Document Portal</div>
</div>
{% elif template == 'crypto' %}
<div class="tpl-crypto-header">
  <div class="tpl-crypto-logo">â‚¿ CryptoVault</div>
  <div class="tpl-crypto-sub">Encrypted Key Delivery</div>
</div>
{% endif %}

{# â”€â”€ AVAILABLE: show reveal button â”€â”€ #}
{% if state == 'available' %}

  <div class="secret-header">
    <h1>You've received a secret</h1>
    <p>Click the button below to reveal the secret content.</p>
  </div>

  <form method="POST" action="/s/{{ token }}/reveal">
    <button type="submit" class="btn btn-primary reveal-btn">ğŸ”“ &nbsp;Reveal Secret</button>
  </form>

{# â”€â”€ REVEALED: show the content â”€â”€ #}
{% elif state == 'revealed' %}

  <div class="secret-header">
    <h1>ğŸ”“ Secret Revealed</h1>
    {% if burnsOnReveal %}
    <p>This secret has now been destroyed. It cannot be viewed again.</p>
    {% else %}
    <p>The secret content is shown below.</p>
    {% endif %}
  </div>

  <div class="reveal-box">
    <div class="reveal-label">Secret Content</div>
    <div class="reveal-content" id="secretContent">{{ content }}</div>
    <button class="copy-btn" id="copyBtn">Copy</button>
  </div>

  {% if burnsOnReveal %}
  <div class="warn-box">
    âš ï¸ Save this information now. This page will not show it again if you refresh.
  </div>
  {% endif %}

{# â”€â”€ BURNED or UNAVAILABLE â”€â”€ #}
{% else %}

  <div class="secret-header">
    <h1>Secret Unavailable</h1>
    <p>This secret has already been viewed, has expired, or does not exist.</p>
  </div>

  <div class="warn-box">
    âš ï¸ Each secret can only be viewed once. If you believe this is an error, contact the person who sent you this link.
  </div>

  <a href="/" class="btn btn-secondary">Create Your Own Secret</a>

{% endif %}

{% endblock %}
